<html>
<head>
<meta charset="UTF-8"/>
<style>
html, body {
 width: 100%;
 height: 100%;
 margin: 0px;
 border: 0;
 overflow: hidden; /*  Disable scrollbars */
 display: block;  /* No floating content on sides */
 background-color: #000000;
}
</style>
<script type="text/javascript">
var url = "latest.jpg"; //url to load image from
var refreshInterval = 15000; //in ms
var drawDate = false; //draw date string
var img;

function init() {
    var canvas = document.getElementById("canvas");
    var context = canvas.getContext("2d");

    img = new Image();
    img.onload = function() {
        canvas.setAttribute("width", window.innerWidth);
        canvas.setAttribute("height", window.innerHeight);

        var hRatio = canvas.width  / this.width;
        var vRatio =  canvas.height / this.height;
        var ratio  = Math.min ( hRatio, vRatio ); 
        var centerShift_x = ( canvas.width - this.width * ratio ) / 2;
        var centerShift_y = ( canvas.height - this.height * ratio ) / 2;

        context.drawImage(this, 0, 0, this.width, this.height,
                                centerShift_x, centerShift_y, this.width * ratio, this.height * ratio);

        if(drawDate) {
            var now = new Date();
            var text = now.toLocaleDateString() + " " + now.toLocaleTimeString();
            var maxWidth = 100;
            var x = canvas.width-10-maxWidth;
            var y = canvas.height-10;

            context.strokeStyle = 'black';
            context.lineWidth = 2;
            context.strokeText(text, x, y, maxWidth);
            context.fillStyle = 'white';
            context.fillText(text, x, y, maxWidth);
        }
    };

    refresh();
}

function refresh() {
    img.src = url + "?t=" + new Date().getTime();
    setTimeout(refresh, refreshInterval);
}

function setResizeHandler(callback, timeout) {
    var timer_id = undefined;
    window.addEventListener("resize", function() {
        if(timer_id != undefined) {
            clearTimeout(timer_id);
            timer_id = undefined;
        }
        timer_id = setTimeout(function() {
            timer_id = undefined;
            callback();
        }, timeout);
    });
}

function resize_callback() {
    refresh();
}
setResizeHandler(resize_callback, 500);

</script>
<title>Timelapse</title>
</head>

<body onload="JavaScript:init();">
<canvas id="canvas"/>
</body>
</html>
